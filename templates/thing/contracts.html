{% extends "base.html" %}
{% load thing_extras %}
  
{% block title %}Contracts{% endblock %}

{% block extra_head %}
    <script type="text/javascript">
      $(document).ready(function () {
        // call the tablesorter plugin
        $("#contracts-table").tablesorter({
          'sortList': [[0, 1]],
        });
      });

    </script>
{% endblock %}

{% block content %}
      <div class="row-fluid">
        <div class="span12">
          <h2>Contracts</h2>
          <table id="contracts-table" class="table table-striped table-bordered table-condensed">
            <thead>
              <tr class="c">
                <th>ID</th>
                <th>Issued</th>
                <th>Issued By</th>
                <th>Type</th>
                <th>Status</th>
                <th>Assigned To</th>
                <th>Accepted By</th>
                <th>Accepted/Completed</th>
              </tr>
            </thead>
            <tbody>
              {% for contract in contracts -%}
              <tr>
                <td class="con-id">{{ contract.contract_id }}</td>
                <td class="con-date">{{ contract.date_issued }}</td>
                <td class="con-issuer">
                  {% if contract.for_corp -%}
                  <i class="icons-corporation"></i>
                  {{ contract.issuer_corp.name }}
                  {%- else -%}
                  <i class="icons-player"></i>
                  {{ contract.issuer_char.name }}
                  {%- endif %}
                </td>
                <td class="c con-type">{{ contract.type }}</td>
                <td class="con-status">
                  <i class="icons-contract-{{ contract.z_status_icon }}"></i>
                  {{ contract.status }}
                </td>
                <td class="con-issuer">
                  {% if contract.assignee_alliance -%}
                  <i class="icons-alliance"></i>
                  {{ contract.assignee_alliance.name }}
                  {%- elif contract.assignee_corp -%}
                  <i class="icons-corporation"></i>
                  {{ contract.assignee_corp.name }}
                  {%- elif contract.assignee_char -%}
                  <i class="icons-player"></i>
                  {{ contract.assignee_char.name }}
                  {%- else -%}
                  <i class="icons-contract-public"></i>
                  Public
                  {%- endif %}
                </td>
                <td class="con-issuer">
                  {% if contract.acceptor_corp -%}
                  <i class="icons-corporation"></i>
                  {{ contract.acceptor_corp.name }}
                  {%- elif contract.acceptor_char -%}
                  <i class="icons-player"></i>
                  {{ contract.acceptor_char.name }}
                  {%- else -%}
                  --
                  {%- endif %}
                </td>
                <td class="con-date">
                  {% if contract.status == 'InProgress' -%}
                  {{ contract.date_accepted }}
                  {%- elif contract.status == 'Completed' -%}
                  {{ contract.date_completed }}
                  {%- else -%}
                  --
                  {%- endif %}
                </td>
              </tr>
              {%- else -%}
              <tr>
                <td>No contracts.</td>
              </tr>
              {%- endfor %}
            </tbody>
          </table>
        </div>
      </div>
{% endblock %}
